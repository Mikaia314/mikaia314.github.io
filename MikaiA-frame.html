<html>
  <head>
      <!-- オブリビエイト（忘れよ） -->
	  <title>MikaiA-frame</title>
	  <link rel="icon" href="favicon2.ico" type="image/vnd.microsoft.icon">
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.1/dist/aframe-environment-component.min.js"></script>

    <script>
      AFRAME.registerComponent("hit-box1", {
        init: function () {
          let visible = false;
          const iconimage = document.getElementById("iconimage");
          const iconcube = document.getElementById("iconcube");
          iconcube.addEventListener("mouseup", () => {
            if (visible == false) {
              iconimage.emit("iconcubePush");
              visible = true;
            }
          });
        } /*
        init: function () {
          const aimiaimage = document.getElementById("aimiaimage");
          const aimiamodel = document.getElementById("aimiamodel");
          aimiamodel.addEventListener("mouseup", () => {
            aimiaimage.emit("aimiamodelPush");
          });
        },*/,
      });
    </script>
    <script>
      AFRAME.registerComponent("hit-box2", {
        /*
        init: function () {
          const iconimage = document.getElementById("iconimage");
          const iconcube = document.getElementById("iconcube");
          iconcube.addEventListener("mouseup", () => {
            iconimage.emit("iconcubePush");
          });
        },*/
        init: function () {
          let visible = false;
          const aimiaimage = document.getElementById("aimiaimage");
          const aimiamodel = document.getElementById("aimiamodel");
          aimiamodel.addEventListener("mouseup", () => {
            if (visible == false) {
              aimiaimage.emit("aimiamodelPush");

              visible = true;
            }
          });
        },
      });
    </script>
  </head>

  <body>
    <a-scene
      overlay-visibility=""
      class="fullscreen"
      fog="density:0;color:#bdaa82;far:84"
      inspector=""
      keyboard-shortcuts=""
      screenshot=""
      vr-mode-ui=""
      ><canvas
        class="a-canvas"
        data-aframe-canvas="true"
        width="300"
        height="150"
      ></canvas>

      <!-- スカイボックス（aframe-environment-component生成） -->
      <a-entity
        environment="preset:              yavapai;
                     active:              true;
                     seed:                11;
                     skyType:             gradient;
                     skyColor:            #239849;
                     horizonColor:        #cfe0af;
                     lightPosition:       0.5 1 0;
                     fog:                 0.8;
                     flatShading:         true;
                     ground:              canyon;
                     groundYScale:        9.76;
                     groundTexture:       walkernoise;
                     groundColor:         #C66344;
                     groundColor2:        #c96b4b;
                     dressing:            stones;
                     dressingAmount:      500;
                     dressingColor:       #C66344;
                     dressingScale:       0.06;
                     dressingVariance:    0.2 0.1 0.2;
                     dressingOnPlayArea:  1;
                     gridColor:           #239893"
        preset-switcher=""
        id="environment"
        ><a-entity
          class="environment"
          position="0 50 0"
          light="intensity:0.6;color:#FFF;groundColor:#C66344;type:ambient"
        ></a-entity
        ><a-entity
          rotation="-90 0 0"
          class="environmentGround environment"
          scale="1 1 9.76"
          shadow="cast:false;receive:false"
        ></a-entity
        ><a-entity class="environmentDressing environment"></a-entity
        ><a-sky
          radius="200"
          theta-length="110"
          class="environment"
          geometry=""
          material="npot:false;shader:gradientshader;topColor:#239849;bottomColor:#cfe0af"
        ></a-sky
        ><a-entity id="stars" visible="false"></a-entity
      ></a-entity>

      <!-- アイコンキューブ読み込み -->
      <a-assets>
        <img
          id="icontexture"
          src="https://cdn.glitch.global/4e992269-6dcc-48d0-bedd-55bc02f4d070/mikaia.png?v=1651062791211"
        />
      </a-assets>

      <!-- アイコンキューブ説明画像読み込み -->
      <a-assets>
        <img
          id="icon-image"
          src="https://cdn.glitch.global/4e992269-6dcc-48d0-bedd-55bc02f4d070/%E7%84%A1%E9%A1%8C.png?v=1697367004113"
        />
      </a-assets>
      <!-- アイコンキューブ -->
      <a-entity position="0 1.7 -20">
        <a-entity
          animation="property: rotation; from: 0 0 0; to: 0 360 0; loop: true; dur: 10000; easing: linear;"
        >
          <a-box
            id="iconcube"
            class="raycastable"
            src="#icontexture"
            animation="property: rotation; from: 0 0 0; to: 360 0 0; loop: true; dur: 20000; easing: linear;"
            material="shader: flat;"
            hit-box1
          ></a-box>
        </a-entity>
        <!-- アイコンキューブ説明画像-->
        <a-image
          id="iconimage"
          position="0 2 0"
          src="#icon-image"
          width="4"
          height="2"
          opacity="0"
          animation="property: opacity;from: 0; to: 1; dur: 3000; loop: false; easing: linear; startEvents: iconcubePush"
        ></a-image>
      </a-entity>

      <!-- 3Dモデル読み込み -->
      <a-assets>
        <a-asset-item
          id="AimiAModel"
          src="https://cdn.glitch.global/4e992269-6dcc-48d0-bedd-55bc02f4d070/AimiA06syeipu.glb?v=1697351085191"
        ></a-asset-item>
      </a-assets>

      <!-- あいみあ説明画像読み込み -->
      <a-assets>
        <img
          id="aimia-image"
          src="https://cdn.glitch.global/4e992269-6dcc-48d0-bedd-55bc02f4d070/無題yi.otuirymjunthsbg.png?v=1697371163714"
        />
      </a-assets>
      <!-- 3Dモデル -->
      <a-entity position="4 1.7 -20">
        <a-entity
          animation="property: rotation; from: 0 0 0; to: 0 360 0; loop: true; dur: 10000; easing: linear;"
        >
          <a-entity
            id="aimiamodel"
            class="raycastable"
            gltf-model="#AimiAModel"
            animation="property: rotation; from: 0 0 0; to: 360 0 0; loop: true; dur: 20000; easing: linear; "
            material="shader: flat;"
            hit-box2
          ></a-entity
        ></a-entity>
        <!-- あいみあ説明画像-->
        <a-image
          id="aimiaimage"
          position="0 2 0"
          src="#aimia-image"
          width="4"
          height="2"
          opacity="0"
          animation="property: opacity;from: 0; to: 1; dur: 3000; loop: false; easing: linear; startEvents: aimiamodelPush"
        ></a-image>
      </a-entity>

      <!-- マウスカーソル -->
      <a-entity
        id="mouseCursor"
        cursor="rayOrigin: mouse"
        raycaster="objects: .raycastable"
      ></a-entity>
    </a-scene>
  </body>
</html>
